"use strict";const e=require("../common/vendor.js"),t=require("../utils/request.js"),r=require("../stores/appStore.js"),s=require("../types/event.types.js"),o=require("../utils/emitter.js"),p=()=>r.useAppStore().getUser(),u=e.computed((()=>{const{user:t}=e.storeToRefs(r.useAppStore());return console.log("storeToRefs(useAppStore())",t.value),e.index.setStorageSync("refreshToken",t.value.refresh_token),!!t.value.refresh_token}));exports.creatOrder=e=>t.request("/pay/order",{method:"POST",data:e}),exports.getApps=()=>t.request("workflow/getAllWorkflowApps/mp"),exports.getLoginInfo=p,exports.getOrderInfoById=e=>t.request("/pay/query",{method:"POST",data:{_id:e}}),exports.getPageContent=()=>t.request("content/mp/content"),exports.getPrePay=e=>t.request(`pay/prePay/${e}`),exports.getProductList=()=>t.request("/product"),exports.getUserVipInfo=()=>t.request("/member/topLevel",{method:"POST"}),exports.isLogin=u,exports.loginByUsername=e=>t.request("/users/loginByUsername",{method:"POST",data:e}),exports.loginByWechatCode=e=>t.request(`auth/loginByWechatMiniProgram?code=${e}`),exports.loginOut=()=>{r.useAppStore().clearUser(),o.emit(s.EventType.AUTH_LOGOUT,null)},exports.refreshUserInfo=(e=p())=>t.request(`/users/${e._id}`).then((e=>{r.useAppStore().setUser(e)})),exports.saveLoginInfo=e=>r.useAppStore().setUser(e),exports.updateUserInfo=e=>t.request("/users/update",{method:"POST",data:e});
