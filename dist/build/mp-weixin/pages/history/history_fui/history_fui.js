"use strict";const e=require("../../../common/vendor.js"),o=require("../../../common/assets.js"),t=require("../../../utils/request.js"),i=require("../../../utils/common.js"),s=require("../../../composables/useCommon.js");if(!Array){(e.resolveComponent("fui-background-image")+e.resolveComponent("fui-tabs")+e.resolveComponent("fui-sticky")+e.resolveComponent("fui-section")+e.resolveComponent("fui-icon")+e.resolveComponent("fui-load-ani")+e.resolveComponent("fui-collapse-item")+e.resolveComponent("fui-timeaxis-node")+e.resolveComponent("fui-timeaxis")+e.resolveComponent("fui-waterfall-item")+e.resolveComponent("fui-waterfall"))()}Math||((()=>"../../../components/firstui/fui-background-image/fui-background-image.js")+(()=>"../../../components/firstui/fui-tabs/fui-tabs.js")+(()=>"../../../components/firstui/fui-sticky/fui-sticky.js")+(()=>"../../../components/firstui/fui-section/fui-section.js")+(()=>"../../../components/firstui/fui-icon/fui-icon.js")+(()=>"../../../components/firstui/fui-load-ani/fui-load-ani.js")+(()=>"../../../components/firstui/fui-collapse-item/fui-collapse-item.js")+(()=>"../../../components/firstui/fui-timeaxis-node/fui-timeaxis-node.js")+(()=>"../../../components/firstui/fui-timeaxis/fui-timeaxis.js")+(()=>"../../../components/firstui/fui-waterfall-item/fui-waterfall-item.js")+(()=>"../../../components/firstui/fui-waterfall/fui-waterfall.js"))();const a=e.defineComponent({__name:"history_fui",setup(a){e.onLoad((()=>{s.isLogin.value||e.index.showToast({icon:"error",title:"您还没有登录",duration:2e3,complete(){setTimeout((()=>{e.index.navigateBack()}),2e3)}}),r()}));const n=e.ref([]),r=async e=>{const{items:o}=await t.request(`/draw/history/${e}`);n.value=o,console.log("pageNumber",e),console.log("historyData",n.value)},u=async o=>{try{console.log("Attempting to remove history record with id:",o);const i=await t.request(`/draw/history/${o}`,{method:"DELETE"});console.log("Response status:",i.status),console.log("History record removed:",o),n.value=n.value.filter((e=>e._id!==o)),console.log("Updated historyData:",n.value),e.index.showToast({title:"删除成功",icon:"success",duration:2e3})}catch(i){console.error("Failed to remove history record:",i)}};e.computed((()=>{const e=[];return n.value.forEach((o=>{const t=i.formatDateTime(new Date(o.created_at),"YYYY-MM-DD"),s=e.find((e=>e.day===t));s?s.data=[...s.data,o]:e.push({day:t,icon:"creative",data:[o]})})),console.log("tempTimeLineData:",e),e.sort(((e,o)=>new Date(o.day).getTime()-new Date(e.day).getTime()))})),e.computed((()=>{let e=[];return n.value.forEach((o=>{o.output&&(e=[...e,...o.output])})),e}));const l=["https://chinahu-ai-server.oss-cn-chengdu.aliyuncs.com/aidraw/image/temps/6787db82dd3d12610cbb21bd/ComfyUI_0001.png"],c=e.ref(0),f=e.ref(["时间轴模式","相册模式"]);function p(e){console.log("-----------------------------------",e),c.value=e.index}const m=e.ref(!1);function d(){m.value=!0}function v(e){if("string"!=typeof e)return 2;return/\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(e)?0:/\.(mp4|avi|mov|mkv|flv|wmv)$/i.test(e)?1:2}return(t,i)=>e.e({a:e.p({src:"@/src/static/Home2 (1).jpgHome2(1).jpg"}),b:e.o(p),c:e.p({tabs:f.value}),d:o._imports_0,e:e.p({title:"历史生图记录","margin-top":"25",descrSize:"32",descrColor:"#000000",descr:"时间轴模式下长按图片可以将图片保存或分享给朋友"}),f:0==c.value},0==c.value?{g:e.f(n.value,((o,i,s)=>{var a,n,r,c,f;return e.e({a:2==o.status},2==o.status?{b:"55ef6b81-6-"+s+",55ef6b81-5-"+s,c:e.p({name:"clear-fill",size:28,color:"#fff"})}:{},{d:1==o.status},1==o.status?{e:"55ef6b81-7-"+s+",55ef6b81-5-"+s,f:e.p({name:"face",size:28,color:"#fff"})}:{},{g:0==o.status},0==o.status?{h:"55ef6b81-8-"+s+",55ef6b81-5-"+s,i:e.p({type:"3"})}:{},{j:0==v(o.output[0])},0==v(o.output[0])?{k:"55ef6b81-9-"+s+",55ef6b81-5-"+s,l:e.p({title:"提示词",descr:null==(a=o.params)?void 0:a.positive,descrSize:"32",descrColor:"#000000"}),m:e.o(d,i),n:t.scaleToFill,o:o.output[0],p:e.o((e=>u(o._id)),i),q:"55ef6b81-10-"+s+",55ef6b81-5-"+s,r:e.p({color:"#ff0000",name:"delete"})}:1==v(o.output[0])?{t:"55ef6b81-11-"+s+",55ef6b81-5-"+s,v:e.p({title:"提示词",descr:null==(n=o.params)?void 0:n.positive}),w:o.output[0],x:e.o((e=>u(o._id)),i),y:"55ef6b81-12-"+s+",55ef6b81-5-"+s,z:e.p({color:"#ff0000",name:"delete"}),A:e.o((t=>async function(o){const t=o;try{const o=await e.index.downloadFile({url:t});if(200===o.statusCode){const{tempFilePath:t}=o;await e.index.saveVideoToPhotosAlbum({filePath:t}),e.index.showToast({title:"下载成功",icon:"success"})}else console.error("下载失败，状态码:",o.statusCode),e.index.showToast({title:"下载失败",icon:"none"})}catch(i){console.error("下载失败:",i),e.index.showToast({title:"下载失败",icon:"none"})}}(o.output[0])),i),B:"55ef6b81-13-"+s+",55ef6b81-5-"+s,C:e.p({color:"#e0e0e0",name:"pulldown"})}:{D:"55ef6b81-14-"+s+",55ef6b81-5-"+s,E:e.p({title:"提示词",descrSize:"32",descrColor:"#000000",descr:null==(r=o.params)?void 0:r.positive}),F:(null==(c=o.params)?void 0:c.image_path_mask)||(null==(f=o.params)?void 0:f.image_path_origin)||l,G:e.o((e=>u(o._id)),i),H:"55ef6b81-15-"+s+",55ef6b81-5-"+s,I:e.p({color:"#ff0000",name:"delete"}),J:e.o((t=>{return i=o.output[0],void e.index.setClipboardData({data:i,showToast:!0,success:function(){console.log("复制成功")},fail:function(e){console.error("复制失败",e)}});var i}),i),K:e.t(o.output[0]),L:"55ef6b81-16-"+s+",55ef6b81-5-"+s,M:e.p({background:"transparent "})},{s:1==v(o.output[0]),N:i,O:"55ef6b81-5-"+s+",55ef6b81-4"})})),h:e.p({padding:["32rpx","16rpx"]})}:{},{i:1==c.value},1==c.value?{j:e.f(n.value,((o,i,s)=>{var a,n;return e.e({a:0==v(o.output[0])},0==v(o.output[0])?{b:t.scaleToFill,c:o.output[0]}:1==v(o.output[0])?{e:o.output[0]}:{f:(null==(a=o.params)?void 0:a.image_path_mask)||(null==(n=o.params)?void 0:n.image_path_origin)||l},{d:1==v(o.output[0]),g:i,h:"55ef6b81-18-"+s+",55ef6b81-17"})}))}:{})}}),n=e._export_sfc(a,[["__scopeId","data-v-55ef6b81"]]);wx.createPage(n);
