"use strict";const e=require("../common/vendor.js"),o=require("../stores/appStore.js");if(!Array){(e.resolveComponent("fui-background-image")+e.resolveComponent("up-swiper")+e.resolveComponent("fui-parse")+e.resolveComponent("fui-parse-group")+e.resolveComponent("fui-fab"))()}Math||((()=>"./firstui/fui-background-image/fui-background-image.js")+(()=>"../node-modules/uview-plus/components/u-swiper/u-swiper.js")+t+(()=>"./firstui/fui-parse/fui-parse.js")+(()=>"./firstui/fui-parse-group/fui-parse-group.js")+(()=>"./firstui/fui-fab/fui-fab.js")+u)();const u=()=>"./common/MyPopup.js",t=()=>"../node-modules/@tuniao/tnui-vue3-uniapp/components/icon/src/icon.js",a="https://chinahu-ai-server.oss-cn-chengdu.aliyuncs.com/aidraw/image/temps/onloading_bg.jpg",s=e.defineComponent({__name:"TaskProgress",props:{modelValue:{default:!1},modelModifiers:{}},emits:["update:modelValue"],setup(u){const t=e.ref(0);e.watch(t,(()=>{console.log("currentSwiperIndex",t.value)}));const{localTasks:s}=e.storeToRefs(o.useAppStore()),l=e.computed((()=>{e.index.setStorageSync("name",s.value);return e.index.getStorageSync("name")})),n=e.computed((()=>0===s.value.length?[a]:s.value.map((e=>1===e.status?e.output[0]:a)))),r=e.computed((()=>{if(0===s.value.length)return"暂无任务";const e=s.value[t.value];return e&&4===e.status?e.progress+"%":e&&0===e.status&&e.queue?`对列:${e.queue},预计:${e.time_remained}s`:""})),i=e.computed((()=>{const e=s.value[t.value];return e&&1===e.status?e.output.length:0})),p=e.computed((()=>{var e;return 1!==(null==(e=s.value[t.value])?void 0:e.status)})),c=e.ref({}),v=()=>{const o=e.index.createAnimation({duration:500,timingFunction:"ease"});return o.opacity(0).step(),c.value=o.export(),o};function f(e){t.value=e.current}const m=e.useModel(u,"modelValue"),d=()=>{const e=v();e.opacity(0).step(),c.value=e.export()},g=()=>{const e=v();e.opacity(1).step(),setTimeout((()=>c.value=e.export()),200)},h=()=>s.value.findIndex((e=>4===e.status));function x(e){return/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/.test(e)?1:2}function w(e){const o=/\.(jpg|jpeg|png|gif|bmp)$/i,u=/\.(mp4|avi|mov|mkv|flv|wmv)$/i;if(!e)return console.log("==============","是空值"),0;if(1==x(e)){if(o.test(e))return console.log("==============","是图片"),1;if(u.test(e))return console.log("==============","是视频"),2}return 2==x(e)?3:void 0}e.onShow((()=>{const e=h();console.log("task onshow",e),-1!==e&&(t.value=h())}));const j=e.ref(),y=e.ref(""),C=e.ref(0),_=e.ref([{class:"pic",params:"",output:"",textImg:" "}]);e.computed((()=>{var e,o,u,a,l,n,r,i;console.log("----------------------------{{generateParams}}----------------",s.value[t.value]);const p=null==(e=s.value[t.value])?void 0:e.output[t.value],c=w(p);_.value=[],0===c?C.value=0:1===c?(C.value=0,_.value.push({class:"pic",params:(null==(o=s.value[t.value])?void 0:o.params)||"",output:p,textImg:" "}),console.log("----------------------------{{generateParams}}------allValueList----------",_.value),j.value=p,y.value="",console.log("----------output---showOrSleep.value = 0;---------",p)):2===c?(_.value.push({class:"video",params:(null==(u=s.value[t.value])?void 0:u.params)||"",output:p,textImg:" "}),C.value=1,y.value="",j.value="output",console.log("----------output---showOrSleep.value = 1;---------",p)):3===c&&(_.value.push({class:"text",params:(null==(a=s.value[t.value])?void 0:a.params)||"",output:p,textImg:null==(n=null==(l=s.value[t.value])?void 0:l.params)?void 0:n.image_path_mask}),C.value=2,y.value=p,console.log("----------output---showOrSleep.value = 2;---------",p,_),j.value=null==(i=null==(r=s.value[t.value])?void 0:r.params)?void 0:i.image_path_mask)}));const b=()=>{const o=s.value[t.value];o&&1===o.status&&(console.log("preview"),e.index.previewImage({urls:o.output}))},k=[{name:"edit",text:"复制文本"}];e.ref(!1);const S=e.ref(0);function A(e){S.value=e.detail.current}return console.log("--------****************------------",l,s),(o,u)=>e.e({a:e.p({src:"https://chinahu-ai-server.oss-cn-chengdu.aliyuncs.com/aidraw/image/temps/67873d6c232a3c5d52240dd6/%C3%A7%C2%A4%C2%BE%C3%A4%C2%BA%C2%A4APP.jpg"}),b:e.f(l.value,((o,u,s)=>{var l;return e.e({a:1==w(o.output[0])},1==w(o.output[0])?{b:e.o(b,u),c:e.o(f,u),d:"ff8314f5-2-"+s+",ff8314f5-0",e:e.p({current:t.value,list:n.value,previousMargin:"20",nextMargin:"20",imgMode:"aspectFill",height:"500",indicator:!0,indicatorMode:"line",circular:!0,autoplay:!1,radius:"20",keyName:"url",indicatorStyle:"bottom"}),f:"ff8314f5-3-"+s+",ff8314f5-0",g:e.p({name:"starry",size:"50"}),h:e.t(o.params.positive)}:{},{i:2==w(o.output[0])},2==w(o.output[0])?{j:o.output[0]}:{},{k:3==w(o.output[0])},3==w(o.output[0])?{l:(null==(l=null==o?void 0:o.params)?void 0:l.image_path_origin)||a,m:"ff8314f5-5-"+s+",ff8314f5-4-"+s,n:e.p({nodes:o.output[0],language:"html"}),o:"ff8314f5-4-"+s+",ff8314f5-0",p:e.p({thBgcolor:!1}),q:e.o((u=>{return t=u,a=o.output[0],void(0==t.index?(console.log("---------------(e)------------",t),e.index.setClipboardData({data:a,showToast:!0,success:function(){console.log("复制成功")},fail:function(e){console.error("复制失败",e)}})):1==t.index&&e.index.value.toast("还在开发中....."));var t,a}),u),r:"ff8314f5-6-"+s+",ff8314f5-0",s:e.p({position:"left",fabs:k})}:{},{t:u})})),c:e.o(A),d:p.value},p.value?{e:e.p({name:"starry",size:"100",color:"tn-white"}),f:e.t(r.value),g:c.value}:{},{h:e.p({name:"image"}),i:e.t(i.value),j:e.o(g),k:e.o(d),l:e.o((e=>m.value=e)),m:e.p({modelValue:m.value})})}}),l=e._export_sfc(s,[["__scopeId","data-v-ff8314f5"]]);wx.createComponent(l);
