"use strict";const e=require("../common/vendor.js"),a=require("../stores/appStore.js");if(!Array){(e.resolveComponent("fui-background-image")+e.resolveComponent("up-swiper")+e.resolveComponent("fui-parse")+e.resolveComponent("fui-parse-group")+e.resolveComponent("fui-fab"))()}Math||((()=>"./firstui/fui-background-image/fui-background-image.js")+(()=>"../node-modules/uview-plus/components/u-swiper/u-swiper.js")+u+(()=>"./firstui/fui-parse/fui-parse.js")+(()=>"./firstui/fui-parse-group/fui-parse-group.js")+(()=>"./firstui/fui-fab/fui-fab.js")+o)();const o=()=>"./common/MyPopup.js",u=()=>"../node-modules/@tuniao/tnui-vue3-uniapp/components/icon/src/icon.js",t="https://chinahu-ai-server.oss-cn-chengdu.aliyuncs.com/aidraw/image/temps/onloading_bg.jpg",s=e.defineComponent({__name:"TaskProgress",props:{modelValue:{default:!1},modelModifiers:{}},emits:["update:modelValue"],setup(o){const u=e.ref(0);e.watch(u,(()=>{console.log("currentSwiperIndex",u.value)}));const{localTasks:s}=e.storeToRefs(a.useAppStore()),l=e.computed((()=>{e.index.setStorageSync("name",s.value);return e.index.getStorageSync("name")})),n=e.computed((()=>0===s.value.length?[t]:s.value.map((e=>1===e.status?e.output[0]:t)))),r=e.computed((()=>{if(0===s.value.length)return"暂无任务";const e=s.value[u.value];return e&&4===e.status?e.progress+"%":e&&0===e.status&&e.queue?`对列:${e.queue},预计:${e.time_remained}s`:""})),i=e.computed((()=>{const e=s.value[u.value];return e&&1===e.status?e.output.length:0})),p=e.computed((()=>{var e;return 1!==(null==(e=s.value[u.value])?void 0:e.status)})),c=e.ref({}),v=()=>{const a=e.index.createAnimation({duration:500,timingFunction:"ease"});return a.opacity(0).step(),c.value=a.export(),a};function d(e){u.value=e.current}const m=e.useModel(o,"modelValue"),g=()=>{const e=v();e.opacity(0).step(),c.value=e.export()},f=()=>{const e=v();e.opacity(1).step(),setTimeout((()=>c.value=e.export()),200)},h=()=>s.value.findIndex((e=>4===e.status));function x(e){return/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/.test(e)?1:2}function w(e){const a=/\.(jpg|jpeg|png|gif|bmp)$/i,o=/\.(mp4|avi|mov|mkv|flv|wmv)$/i;if(!e)return console.log("==============","是空值"),0;if(1==x(e)){if(a.test(e))return console.log("==============","是图片"),1;if(o.test(e))return console.log("==============","是视频"),2}return 2==x(e)?3:void 0}e.onShow((()=>{const e=h();console.log("task onshow",e),-1!==e&&(u.value=h())}));const j=e.ref(),y=e.ref(""),C=e.ref(0),_=e.ref([{class:"pic",params:"",output:"",textImg:" "}]);e.computed((()=>{var e,a,o,t,l,n,r,i;console.log("----------------------------{{generateParams}}----------------",s.value[u.value]);const p=null==(e=s.value[u.value])?void 0:e.output[u.value],c=w(p);_.value=[],0===c?C.value=0:1===c?(C.value=0,_.value.push({class:"pic",params:(null==(a=s.value[u.value])?void 0:a.params)||"",output:p,textImg:" "}),console.log("----------------------------{{generateParams}}------allValueList----------",_.value),j.value=p,y.value="",console.log("----------output---showOrSleep.value = 0;---------",p)):2===c?(_.value.push({class:"video",params:(null==(o=s.value[u.value])?void 0:o.params)||"",output:p,textImg:" "}),C.value=1,y.value="",j.value="output",console.log("----------output---showOrSleep.value = 1;---------",p)):3===c&&(_.value.push({class:"text",params:(null==(t=s.value[u.value])?void 0:t.params)||"",output:p,textImg:null==(n=null==(l=s.value[u.value])?void 0:l.params)?void 0:n.image_path_mask}),C.value=2,y.value=p,console.log("----------output---showOrSleep.value = 2;---------",p,_),j.value=null==(i=null==(r=s.value[u.value])?void 0:r.params)?void 0:i.image_path_mask)}));const b=()=>{const a=s.value[u.value];a&&1===a.status&&(console.log("preview"),e.index.previewImage({urls:a.output}))},k=[{name:"edit",text:"复制文本"}];e.ref(!1);const S=e.ref(0);function A(e){S.value=e.detail.current}return console.log("--------****************------------",l,s),(a,o)=>e.e({a:e.p({src:"https://chinahu-ai-server.oss-cn-chengdu.aliyuncs.com/aidraw/image/temps/67873d6c232a3c5d52240dd6/%C3%A7%C2%A4%C2%BE%C3%A4%C2%BA%C2%A4APP.jpg"}),b:e.f(l.value,((a,o,s)=>{var l;return e.e({a:1==w(a.output[0])},1==w(a.output[0])?{b:e.o(b,o),c:e.o(d,o),d:"5a07ed82-2-"+s+",5a07ed82-0",e:e.p({current:u.value,list:n.value,previousMargin:"20",nextMargin:"20",imgMode:"aspectFill",height:"500",indicator:!0,indicatorMode:"line",circular:!0,autoplay:!1,radius:"20",keyName:"url",indicatorStyle:"bottom"}),f:"5a07ed82-3-"+s+",5a07ed82-0",g:e.p({name:"starry",size:"50"}),h:e.t(a.params.positive)}:{},{i:2==w(a.output[0])},2==w(a.output[0])?{j:a.output[0]}:{},{k:3==w(a.output[0])},3==w(a.output[0])?{l:(null==(l=null==a?void 0:a.params)?void 0:l.image_path_origin)||t,m:"5a07ed82-5-"+s+",5a07ed82-4-"+s,n:e.p({nodes:a.output[0],language:"html"}),o:"5a07ed82-4-"+s+",5a07ed82-0",p:e.p({thBgcolor:!1}),q:e.o((o=>{return u=o,t=a.output[0],void(0==u.index?(console.log("---------------(e)------------",u),e.index.setClipboardData({data:t,showToast:!0,success:function(){console.log("复制成功")},fail:function(e){console.error("复制失败",e)}})):1==u.index&&e.index.value.toast("还在开发中....."));var u,t}),o),r:"5a07ed82-6-"+s+",5a07ed82-0",s:e.p({position:"left",fabs:k})}:{},{t:o})})),c:e.o(A),d:p.value},p.value?{e:e.p({name:"starry",size:"100",color:"tn-white"}),f:e.t(r.value),g:c.value}:{},{h:e.p({name:"image"}),i:e.t(i.value),j:e.o(f),k:e.o(g),l:e.o((e=>m.value=e)),m:e.p({modelValue:m.value})})}}),l=e._export_sfc(s,[["__scopeId","data-v-5a07ed82"]]);wx.createComponent(l);
